## 宏

*QML_INTERFACE*表明类符合QML接口规范，可以注册到QML

## 元对象系统

**Qt元对象系统提供了信号槽机制。**

通过几个点实现这个元对象系统的：

1. QObject类是所有对象基类
2. Q_OBJECT宏生命让自定义对象类加入元对象系统。

在编译时候，moc工具检测到Q_OBJECT宏之后，会为其生成一个完整的元对象c++源文件。

强烈建议：所有子类都应该生命Q_OBJECT宏

**除了信号槽机制，元对象系统还提供了一些额外功能：**

- 动态设置属性：`QObject::setProperty()`

## 属性系统

*Q_PROPERTY* QML如果想要访问元对象属性，则需要通过`Q_PROPERTY`宏定义

一个简单例子：声明priority属性跟踪组件优先级。

枚举类型必须通过Q_ENUM()宏注册到元对象系统。注册之后，即可以使用QObject::setProperty()动态设置属性。

```c++
class MyClass : public QObject {
    Q_OBJECT
    Q_PROPERTY(Priority priority READ priority WRITE setPriority NOTIFY priorityChanged FINAL)
public:
    MyClass(QObject* parent = nullptr);
    ~MyClass();

    enum Priority {
        High, Low, VeryHigh, VeryLow
    };
    Q_ENUM(Priority) // 把枚举类型转换为QT数据类型使用
    Priority priority() const {return m_priority;}
    void setPriority(Priority priority) {
        m_priority = priority;
        emit priorityChanged(priority);
    }
signals:
    void priorityChanged(Priority);
private:
    Priority m_priority;
};
```

使用方法1：类实例

```c++
MyClass* instance = new MyClass;
instance->setPriority(MyClass::High);
```

方法2：QObject

```c++
QObject* obj = instance;
instance->setProperty("priority", "VeryHigh");
```







